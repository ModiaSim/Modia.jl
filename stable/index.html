<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Modia</title><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Modia</a></span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Release-Notes"><span>Release Notes</span></a></li><li><a class="tocitem" href="#Old-Release-Notes-(until-28.2.2022)"><span>Old Release Notes (until 28.2.2022)</span></a></li><li><a class="tocitem" href="#Main-developers"><span>Main developers</span></a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="tutorial/Tutorial.html">Modia Tutorial</a></li><li><a class="tocitem" href="tutorial/GettingStarted.html">1 Getting Started</a></li><li><a class="tocitem" href="tutorial/Modeling.html">2 Modeling</a></li><li><a class="tocitem" href="tutorial/Simulation.html">3 Simulation</a></li><li><a class="tocitem" href="tutorial/FloatingPointTypes.html">4 Floating Point Types</a></li><li><a class="tocitem" href="tutorial/Appendix.html">Appendix A</a></li></ul></li><li><a class="tocitem" href="Functions.html">Functions</a></li><li><a class="tocitem" href="Internal.html">Internal</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Home</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ModiaSim/Modia.jl/blob/main/docs/src/index.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Modia-Documentation"><a class="docs-heading-anchor" href="#Modia-Documentation">Modia Documentation</a><a id="Modia-Documentation-1"></a><a class="docs-heading-anchor-permalink" href="#Modia-Documentation" title="Permalink"></a></h1><p><a href="https://github.com/ModiaSim/Modia.jl">Modia</a> is an environment in form of a Julia package to model and simulate physical systems (electrical, mechanical, thermo-dynamical, etc.) described by differential and algebraic equations. A user defines a model on a high level with model components (like a mechanical body, an electrical resistance, or a pipe) that are physically connected together. A model component is constructed by <strong><code>expression = expression</code> equations</strong> or by Julia structs/functions, such as the pre-defined <a href="https://github.com/ModiaSim/Modia3D.jl">Modia3D</a> multibody components. The defined model is symbolically processed (for example, equations might be analytically differentiated) with algorithms from package <a href="https://github.com/ModiaSim/ModiaBase.jl">ModiaBase.jl</a>. From the transformed model a Julia function is generated that is used to simulate the model with integrators from <a href="https://github.com/SciML/DifferentialEquations.jl">DifferentialEquations.jl</a>. The basic type of the floating point variables is usually <code>Float64</code>, but can be set to any type <code>FloatType &lt;: AbstractFloat</code> via <code>@instantiateModel(..., FloatType = xxx)</code>, for example it can be set to <code>Float32, DoubleFloat, Measurement{Float64}, StaticParticles{Float64,100}</code>.</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>The package is registered and is installed with (Julia &gt;= 1.7 is required):</p><pre><code class="language-julia hljs">julia&gt; ]add Modia</code></pre><p>Furthermore, one or more of the following packages should be installed in order to be able to generate plots:</p><pre><code class="language-julia hljs">julia&gt; ]add SignalTablesInterface_PyPlot        # if plotting with PyPlot desired

        # currently under registration
        add SignalTablesInterface_GLMakie       # if plotting with GLMakie desired
        add SignalTablesInterface_WGLMakie      # if plotting with WGLMakie desired
        add SignalTablesInterface_CairoMakie    # if plotting with CairoMakie desired</code></pre><p>or call <code>t = getValues(instantiatedModel, &quot;time&quot;), y = getValues(instantiatedModel, &quot;y&quot;)</code> to retrieve the results in form of vectors and arrays and use any desired plot package for plotting, e.g., <code>plot(t,y)</code>.</p><p>Note, Modia reexports the following definitions</p><ul><li><code>using Unitful</code></li><li><code>using DifferentialEquations</code></li><li><code>using SignalTables</code></li><li>and exports functions <code>CVODE_BDF</code> and <code>IDA</code> of <a href="https://github.com/SciML/Sundials.jl">Sundials.jl</a>.</li></ul><p>As a result, it is usually sufficient to have <code>using Modia</code> in a model to utilize the relevant functionalities of these packages.</p><h2 id="Release-Notes"><a class="docs-heading-anchor" href="#Release-Notes">Release Notes</a><a id="Release-Notes-1"></a><a class="docs-heading-anchor-permalink" href="#Release-Notes" title="Permalink"></a></h2><h3 id="Version-0.9.1"><a class="docs-heading-anchor" href="#Version-0.9.1">Version 0.9.1</a><a id="Version-0.9.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.9.1" title="Permalink"></a></h3><ul><li>Requires SignalTables 0.3.5.</li></ul><ul><li><a href="Functions.html#Modia.@usingModiaPlot"><code>@usingModiaPlot</code></a>: corrected and fixed in docu. Alternatively, @usingPlotPackage can be used, provided package SignalTables is present in your current environment.</li><li>Internal: A function call in the generated code prefixed with <code>Modia.</code>.</li></ul><h3 id="Version-0.9.0"><a class="docs-heading-anchor" href="#Version-0.9.0">Version 0.9.0</a><a id="Version-0.9.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.9.0" title="Permalink"></a></h3><ul><li>This version is slightly <strong>non-backwards</strong> compatible to 0.8.x. Most important, the result handling has been changed. Especially, package <a href="https://github.com/ModiaSim/ModiaResult.jl">ModiaResult.jl</a> has been replaced by package <a href="https://github.com/ModiaSim/SignalTables.jl">SignalTables.jl</a>. Also the plot package interfaces SignalTablesInterface_PyPlot, SignalTablesInterface_GLMakie etc. have been replaced by packages SignalTablesInterface_PyPlot, SignalTablesInterface_GLMakie etc.<br/>In order that plotting works again with your models, you have to add one of the new plot package interfaces, e.g. <code>]add SignalTablesInterface_PyPlot</code>. One benefit is, that the plot packages have now access to all attributes associated with a variable.</li></ul><ul><li>An instantiated model (as returned from <code>@instantiateModel(..)</code>) is now a signal table according to <a href="https://github.com/ModiaSim/SignalTables.jl">SignalTables.jl</a>. This means that all functions defined for a signal table (see <a href="https://modiasim.github.io/SignalTables.jl/stable/Functions/OverviewOfFunctions.html">function overview</a>) can be applied on a simulated model. Hereby, all Var(..) and Par(..) Modia variables are seen as signals of the signal table (so both time varying variables, as well as parameters). See example <code>Modia/test/TestFirstOrder2.jl</code>.<br/>For example, it is now possible to store simulation results (together with all parameter and start values) on file in JSON format with <code>writeSignalTable(filename, instantiatedModel)</code> (or in HDF5 format via <a href="https://github.com/JuliaIO/JLD.jl">JDL</a>). You get an overview of a simulation result via <code>showInfo(instantiatedModel)</code>.</li></ul><ul><li>New functions <a href="Functions.html#Modia.hasParameter"><code>hasParameter</code></a>, <a href="Functions.html#Modia.getParameter"><code>getParameter</code></a>, <a href="Functions.html#Modia.getEvaluatedParameter"><code>getEvaluatedParameter</code></a>,  <a href="Functions.html#Modia.showParameters"><code>showParameters</code></a>, <a href="Functions.html#Modia.showEvaluatedParameters"><code>showEvaluatedParameters</code></a> to get parameter/init/start values by name (e.g. <code>getEvaluatedParameter(instantiatedModel, &quot;a.b.c&quot;)</code>) or show all parameters.</li></ul><ul><li>New functions to add states and algebraic variables from within functions that are not visible in the generated code (see <a href="Internal.html#Variable-definitions-in-functions">Variable definitions in functions</a> and example <code>Modia/test/TestLinearSystems.jl</code>).  This feature is used in the next version of Modia3D to allow (Modia3D) model changes after code generation and to get more light weight code.</li></ul><ul><li>simulate!(..): Maximum number of iterations is switched off (DifferentialEquations.jl option set to: maxiters = Int(typemax(Int32)) ≈ 2e9).</li></ul><ul><li>Docu improved.</li></ul><p><strong>Bug fixes</strong></p><ol><li>A hierarchical model name with a derivative operator, say <code>der(a.b.c)</code>, has now the correct name <code>a.b.der(c)</code> in the result. For example, the plot command needs to be changed to <code>plot(..., &quot;a.b.der(c)&quot;)</code> instead of the previous command <code>plot(..., &quot;der(a.b.c)&quot;)</code>.</li><li>The initial state vector was not always correctly filled with start/init values of the model (is now fixed).</li><li><code>signalNames(instantiatedModel)</code> did sometimes not show the correct signal names available in the result (is now fixed). <code>signalNames</code> is deprecated. Use instead <a href="https://modiasim.github.io/SignalTables.jl/stable/Functions/SignalTables.html#SignalTables.getSignalNames">getSignalNames</a>.</li></ol><p><strong>Non-backwards compatible changes</strong></p><ul><li>Bug fix 1 can lead for some models to warnings and the selected variable is no longer plotted (-&gt; the model needs to be changed).</li></ul><ul><li>Bug fix 2 can lead for some models to a different result (without notice).</li></ul><ul><li>The result data structure is now constructed with <code>deepcopy(..)</code> of every involved result variable. Previously, for some result variables just the variable reference was stored. The effect is that if previously a complex internal data structure was incorporated into the result data structure, then it was present just once. Now, a deepcopy of the data structure is stored at every time instant. Note, a variable <code>v</code> (especially, a complex internal data structure) is not stored in the result if defined as <code>v = Var(hideResult=true)</code>. In some rare cases, <code>deepcopy(..)</code> gives an error (if module variables are, for whatever reason, tried to be copied). Such variables <code>v</code> need to be declared with <code>v = Var(hideResult=true)</code>, in order that this error does not appear (and these variables are then not stored in the result).</li></ul><ul><li>Function <code>rawSignal(instantiatedModel, name)</code>  is no longer supported. Use <a href="https://modiasim.github.io/SignalTables.jl/stable/Functions/SignalTables.html#SignalTables.getValues">getValues</a> or <a href="https://modiasim.github.io/SignalTables.jl/stable/Functions/SignalTables.html#SignalTables.getSignal">getSignal</a> instead.</li></ul><ul><li>Function <code>getPlotSignal(instantiatedModel, name)</code> is no longer supported. Use <a href="https://modiasim.github.io/SignalTables.jl/stable/Functions/SignalTables.html#SignalTables.getFlattenedSignal">getFlattenedSignal</a> instead.</li></ul><ul><li>Function <code>getPath(path, ...)</code> does no longer return a dictionary but a <a href="https://modiasim.github.io/SignalTables.jl/stable/Functions/SignalTables.html#SignalTables.SignalTable">SignalTable</a>.</li></ul><h3 id="Version-0.8.4"><a class="docs-heading-anchor" href="#Version-0.8.4">Version 0.8.4</a><a id="Version-0.8.4-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.4" title="Permalink"></a></h3><ul><li>Fix issue with DiffEqBase, version 6.91.6 and later.</li></ul><h3 id="Version-0.8.3"><a class="docs-heading-anchor" href="#Version-0.8.3">Version 0.8.3</a><a id="Version-0.8.3-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.3" title="Permalink"></a></h3><ul><li>Bug fix: Parameters that are Numbers, but not AbstractFloats, and have no unit defined, e.g. a Bool or an Int parameter, are no longer converted to FloatType in the generated Code.</li></ul><h3 id="Version-0.8.2"><a class="docs-heading-anchor" href="#Version-0.8.2">Version 0.8.2</a><a id="Version-0.8.2-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.2" title="Permalink"></a></h3><ul><li>New exported functions<ul><li>modelToJSON(model; expressionsAsStrings=true)</li><li>JSONToModel(json)</li><li>writeModel(filename, model; log=true)</li><li>readModel(filename; log=true)</li></ul>writeModel saves the model in JSON format on file and readModel reads the model from a JSON file.</li></ul><ul><li><code>Modia/examples/ServoSystem.jl</code> enhanced, so that the hierarchical model with units is first stored in JSON format on file, then the model is read from file, a parameter is modified, and then the model is passed to @instantiateModel(..).</li></ul><ul><li><code>@instantiateModel(...)</code>:<ul><li><code>@instantiateModel(..., logCode=true, ...)</code> provides now correct unit type casts for scalars.</li><li><code>@instantiateModel(..., saveCodeOnFile=fileName, ...)</code> stores the generated code on file <code>fileName</code>.</li><li>Automatically use <code>@instantiatedModel(..., unitless=true, ..)</code>, if <code>FloatType = MonteCarloMeasurements.XXX</code>, because there are easily cases where this fails, if units are present.</li></ul></li></ul><ul><li><code>@showModel model</code>: Nicer pretty print if model is hierarchical.</li></ul><ul><li>New function <code>Modia.unitAsString(unitOfQuantity)</code>, see Unitful issue 412 (https://github.com/PainterQubits/Unitful.jl/issues/412).</li></ul><ul><li>Remove empty hierarchies in model parameters (seen with <code>simulate!(..., logParameters=true)</code>).</li></ul><ul><li>Memory allocation reduced if states or tearing variables are SVectors.</li></ul><ul><li>Improved casting and checking of types in the generated code (see new test model Modia/test/TestUnitAsString.jl).</li></ul><ul><li>Moved ModiaBase.Symbolic.makeDerVar from ModiaBase to new file <code>Modia/src/Symbolic.jl</code> (because makeDerVar needs FloatType for generating type-stable code and FloatType is available in Modia but not in ModiaBase).</li></ul><ul><li>Github actions workflow added for automatic tests on Linux/Windows/MacOS, for pull requests on main.</li></ul><p><strong>Bug fixes</strong></p><ul><li>Fixed issue with unit on macOS (exponents had been displayed as Unicode superscripts when converting the unit to a string, leading to errors in the further processing).</li></ul><ul><li>Hide result only if <code>Var(hideResult=true)</code> (previously, hideResult=false was treated as true).</li></ul><ul><li><code>Modia/models/Rotational.jl</code>: Change some Int to Float64 values, because errors occured in some situations.</li></ul><h3 id="Version-0.8.1"><a class="docs-heading-anchor" href="#Version-0.8.1">Version 0.8.1</a><a id="Version-0.8.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.1" title="Permalink"></a></h3><ul><li>Missing file Modia/test/TestLinearEquations.jl added.</li></ul><h3 id="Version-0.8.0"><a class="docs-heading-anchor" href="#Version-0.8.0">Version 0.8.0</a><a id="Version-0.8.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.0" title="Permalink"></a></h3><p><strong>Non-backwards</strong> compatible changes</p><p>The Modia packages are slightly restructured to allow more efficient operations. Previously, Modia was planned to include all the functionality with all model libraries. This is now changed and Modia includes now equation-oriented modeling and basic model libraries. Further model libraries, such as Modia3D (and other model libraries in the future) must be explicitly imported and are no longer automatically imported by Modia. To simplify the structuring, ModiaLang is merged into Modia and some functionality for the code generation is moved from ModiaBase to Modia. Overall, the benefit is that loading and compilation times are reduced, if Modia3D is not needed. Furthermore, the generated code contains only references to Modia functionality and no longer to ModiaBase. Details of the changes:</p><ul><li>ModiaLang#main 0.11.3 and ModiaLang#development merged into Modia 0.7.0 resulting in the new Modia version 0.8.0 (hereby history of both ModiaLang and of Modia is preserved).</li></ul><ul><li>Modia3D is removed from Modia (so when a model is using Modia3D, the package must be explicitly imported and is no longer automatically imported from Modia).</li></ul><ul><li>Require ModiaBase 0.10 (where EquationAndStateInfo.jl and StateSelection.jl are removed and added to Modia, in order that only references to Modia are in the generated code and no longer references to ModiaBase).</li></ul><h2 id="Old-Release-Notes-(until-28.2.2022)"><a class="docs-heading-anchor" href="#Old-Release-Notes-(until-28.2.2022)">Old Release Notes (until 28.2.2022)</a><a id="Old-Release-Notes-(until-28.2.2022)-1"></a><a class="docs-heading-anchor-permalink" href="#Old-Release-Notes-(until-28.2.2022)" title="Permalink"></a></h2><h3 id="Release-Notes-of-Modia-(until-28.2.2022)"><a class="docs-heading-anchor" href="#Release-Notes-of-Modia-(until-28.2.2022)">Release Notes of Modia (until 28.2.2022)</a><a id="Release-Notes-of-Modia-(until-28.2.2022)-1"></a><a class="docs-heading-anchor-permalink" href="#Release-Notes-of-Modia-(until-28.2.2022)" title="Permalink"></a></h3><h4 id="Version-0.7.0"><a class="docs-heading-anchor" href="#Version-0.7.0">Version 0.7.0</a><a id="Version-0.7.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.0" title="Permalink"></a></h4><p><strong>Non-backwards</strong> compatible changes (basically, these changes are, erronously, in 0.6.1):</p><ul><li>Equations can only be defined with key <code>equations</code> and no other key (still, expressions can be associated with one variable, such as <code>b = Var(:(2*a))</code>). In versions 0.6.0 and before, equations could be associated with any key.</li></ul><ul><li>The merge operator <code>|</code> appends the expression vectors of <code>equations</code>, so <code>m1 | m2</code> basically appends the vector of <code>m2.equations</code> to the vector of <code>m1.equations</code>. In versions 0.6.0 and before, the merge operator did not handle <code>equations</code> specially, and therefore <code>m1 | m2</code> replaced <code>m1.equations</code> by <code>m2.equations</code>.</li></ul><ul><li>Parameter values in the code are now type cast to the type of the parameter value from the <code>@instantiatedModel(..)</code> call. The benefit is that access of parameter values in the code is type stable and operations with the parameter value are more efficient and at run-time no memory is allocated. Existing models can no longer be simulated, if parameter values provided via <code>simulate!(.., merge=xx)</code> are not type compatible to their definition. For example, an error is thrown if the @instantedModel(..) uses a Float64 value and the <code>simulate!(.., merge=xx)</code> uses a <code>Measurement{Float64}</code> value for the same parameter</li></ul><ul><li>Operator <code>buildModia3D(..)</code> as used in Modia3D models is removed. Instead, the new constructor <code>Model3D(..)</code> must be used at the top level of a Modia3D definition. It is now possible to define several, independent multibody systems (currently, only one of them can have animation and animation export).</li></ul><ul><li><code>Var(init=[...])</code> or <code>Var(start=[..])</code> of FreeMotion joints must be defined as <code>Var(init=SVector{3,Float64}(..))</code> or <code>Var(start=SVector{3,Float64}(..))</code>. Otherwise, errors occur during compilation.</li></ul><p>Other changes</p><ul><li>Documentation (especially tutorial) adapted to the new version.</li></ul><ul><li>Examples and test models (Modia/examples, Modia/tests) adapted to the new version, especially to the non-backwards compatible changes.</li></ul><ul><li>For further changes of equation-based models, see the release notes of <a href="https://github.com/ModiaSim/ModiaLang.jl/releases/tag/v0.11.0">ModiaLang 0.11.0</a>.</li></ul><ul><li>For further changes of Modia3D models, see the release notes of <a href="https://github.com/ModiaSim/Modia3D.jl/releases/tag/v0.9.0">Modia3D 0.9.0</a>.</li></ul><h4 id="Version-0.6.1"><a class="docs-heading-anchor" href="#Version-0.6.1">Version 0.6.1</a><a id="Version-0.6.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.6.1" title="Permalink"></a></h4><p>This version was erronously released as 0.6.1. Since it contains non-backwards compatible changes with respect to 0.6.0, this is wrong and should have been released as version 0.7.0.</p><ul><li>See release notes of <a href="https://github.com/ModiaSim/ModiaLang.jl/releases/tag/v0.11.0">ModiaLang</a> and of <a href="https://github.com/ModiaSim/Modia3D.jl/releases/tag/v0.9.0">Modia3D</a>.</li></ul><ul><li>Project.toml and Manifest.toml updated due to new versions of Modia3D and ModiaLang</li></ul><ul><li>docu: fix some typing and formatting</li></ul><h4 id="Version-0.6.0"><a class="docs-heading-anchor" href="#Version-0.6.0">Version 0.6.0</a><a id="Version-0.6.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.6.0" title="Permalink"></a></h4><ul><li>Modia is restricted to Julia 1.7</li><li>cyclic dependencies with Modia3D package are removed</li></ul><h4 id="Version-0.5.2"><a class="docs-heading-anchor" href="#Version-0.5.2">Version 0.5.2</a><a id="Version-0.5.2-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.5.2" title="Permalink"></a></h4><ul><li>Fully reexporting Modia3D and removing duplicate ModiaInterface (see <a href="https://github.com/ModiaSim/Modia3D.jl/releases/tag/v0.6.0">Modia3D release notes 0.6.0</a>).</li></ul><h4 id="Version-0.5.1"><a class="docs-heading-anchor" href="#Version-0.5.1">Version 0.5.1</a><a id="Version-0.5.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.5.1" title="Permalink"></a></h4><ul><li>Using and reexporting ModiaLang 0.8.3 (see <a href="https://github.com/ModiaSim/ModiaLang.jl/releases">release notes 0.8.3 and 0.8.2</a>).</li><li>Using and partially reexporting Modia3D 0.5.1 (see <a href="https://github.com/ModiaSim/Modia3D.jl/releases/tag/v0.5.1">release notes 0.5.1</a>).</li></ul><h4 id="Version-0.5.0"><a class="docs-heading-anchor" href="#Version-0.5.0">Version 0.5.0</a><a id="Version-0.5.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.5.0" title="Permalink"></a></h4><ul><li>Using and reexporting ModiaLang 0.8.1 (see <a href="https://modiasim.github.io/ModiaLang.jl/stable/">release notes</a>).</li><li>Using and partially reexporting Modia3D 0.5.0 (see <a href="https://modiasim.github.io/Modia3D.jl/stable/#Release-Notes">release notes</a>).</li><li>New plot package interface via <a href="https://github.com/ModiaSim/ModiaResult.jl">ModiaResult</a>. Additional support for PyPlot, WGLMakie, CairoMakie (besides GLMakie).</li></ul><h4 id="Version-0.4.0"><a class="docs-heading-anchor" href="#Version-0.4.0">Version 0.4.0</a><a id="Version-0.4.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.4.0" title="Permalink"></a></h4><ul><li>Initial version of new Modia design.</li></ul><h3 id="Release-Notes-of-ModiaLang-(until-28.2.2022)"><a class="docs-heading-anchor" href="#Release-Notes-of-ModiaLang-(until-28.2.2022)">Release Notes of ModiaLang (until 28.2.2022)</a><a id="Release-Notes-of-ModiaLang-(until-28.2.2022)-1"></a><a class="docs-heading-anchor-permalink" href="#Release-Notes-of-ModiaLang-(until-28.2.2022)" title="Permalink"></a></h3><h4 id="Version-0.11.3"><a class="docs-heading-anchor" href="#Version-0.11.3">Version 0.11.3</a><a id="Version-0.11.3-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.11.3" title="Permalink"></a></h4><ul><li>@instantiateModel(..): <code>Var(hideResult=true)</code> is no longer ignored if present in a sub-component.</li></ul><ul><li>simulate!(..): Unnecessary evaluation of the parameters dictionary is avoided (if merge = missing, nothing or has no elements).</li></ul><h4 id="Version-0.11.2"><a class="docs-heading-anchor" href="#Version-0.11.2">Version 0.11.2</a><a id="Version-0.11.2-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.11.2" title="Permalink"></a></h4><ul><li>Minor (efficiency) improvement if states are SVectors.</li></ul><ul><li>Require ModiaBase 0.9.2 (to get rid of performance issues in Modia3D).</li></ul><ul><li>Replace ustrip(..) with ustrip.(..) at some places to get rid of warnings.</li></ul><h4 id="Version-0.11.1"><a class="docs-heading-anchor" href="#Version-0.11.1">Version 0.11.1</a><a id="Version-0.11.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.11.1" title="Permalink"></a></h4><ul><li>Update of Manifest.toml file</li><li>Require ModiaBase 0.9.1 (with updated Manifest.toml file)</li></ul><h4 id="Version-0.11.0"><a class="docs-heading-anchor" href="#Version-0.11.0">Version 0.11.0</a><a id="Version-0.11.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.11.0" title="Permalink"></a></h4><p>Non-backwards compatible changes</p><ul><li>Equations can only be defined with key <code>equations</code> and no other key.</li></ul><ul><li>Parameter values in the code are now type cast to the type of the parameter value from the <code>@instantiatedModel(..)</code> call. The benefit is that access of parameter values in the code is type stable and operations with the parameter value are more efficient and at run-time no memory is allocated. Existing models can no longer be simulated, if parameter values provided via <code>simulate!(.., merge=xx)</code> are not type compatible to their definition. For example, an error is thrown if the @instantedModel(..) uses a Float64 value and the <code>simulate!(.., merge=xx)</code> uses a <code>Measurement{Float64}</code> value for the same parameter</li></ul><p>Other changes</p><ul><li>Hierarchical names in function calls supported (e.g. <code>a.b.c.fc(..)</code>).</li></ul><ul><li>Functions can return multiple values, e.g. <code>(tau1,tau2) = generalizedForces(derw1, derw2)</code>.</li></ul><ul><li>Support for StaticArrays variables (the StaticArrays feature is kept in the generated AST). For an example, see <code>ModiaLang/test/TestArrays.jl</code>.</li></ul><ul><li>Support for Array variables (especially of state and tearing variables) where the dimension can change after <code>@instantiateModel(..)</code>. For examples, see <code>ModiaLang/test/TestArrays.jl</code> and <code>TestMultiReturningFunction10.jl</code>.</li></ul><ul><li>New keyword <code>Var(hideResult=true)</code> removes variable from the result (has no effect on states, derivative of states and parameters). For an example, see <code>ModiaLang/test/TestMultiReturningFunction10.jl</code></li></ul><ul><li>New feature of @instantiatedModel(..): If a Model(..) has key <code>:_buildFunction</code>, call this function to merge additional code to the model. For details see the docu of function buildSubModels! in ModiaLang.jl. For examples, see <code>ModiaLang/test/TestMultiReturningFunction10.jl</code> and constructor <code>Model3D(..)</code> in <code>Modia3D/src/ModiaInterface/model3D.jl</code> and <code>Modia3D/src/ModiaInterface/buildModia3D.jl</code>.</li></ul><ul><li>Generalized connection semantics.</li></ul><ul><li>Functions converting model to/from JSON: <code>modelToJSON(model)</code>, <code>JSONtoModel(json_string)</code></li></ul><ul><li><code>simulate!(..):</code><ul><li>New option <code>logProgress=false</code> in function <code>simulate!(..)</code> to print current simulation time every 5s (cpu-time).</li><li>If tolerance is too small, a warning is prented and it is automatically enlarged to a meaningful value (e.g. tolerance = 1e-8 is not useful if <code>FloatType=Float32</code>)</li><li>Logging improved: If log=true or logTiming=true, then timing, memory allocation and compilation time is reported for initialization (ths includes compilation of the generated getDerivatives(..) function). The remaining log shows cpu-time and memory allocation <strong>without</strong> initialization (and without the resources needed to compile getDerivatives(..)).</li><li>Prefix messages of the timers with &quot;ModiaLang&quot; or &quot;DifferentialEquations&quot; to more clearly see the origin of a message in the timer log.</li></ul></li></ul><ul><li>Large speedup of symbolic transformation, if function depends on many input (and output) arguments (includes new operator <code>implicitDependency(..)</code>).</li></ul><ul><li>Included DAE-Mode in solution of linear equation system (if DAE integrator is used and all unknowns of a linear equation system are part of the DAE states, solve the linear equation system during continuous integration via DAE solver (= usually large simulation speed-up, for larger linear equation systems)</li></ul><p>Bug fixes</p><ul><li>If unitless=true, units in instantiatedModel.evaluatedParameters are removed.</li></ul><ul><li>The unit macro is kept in the generated code and is no longer expanded. For example, <code>u&quot;N&quot;</code>, is kept in the code that is displayed with <code>logCode=true</code> (previously, this was expanded and the unit was displayed in the code as <code>N</code> which is not correct Julia code).</li></ul><ul><li>Function <code>ModiaLang.firstInitialOfAllSegments(..)</code> now correctly returns true for the first call of the getDerivatives function during the simulation.</li></ul><h4 id="Version-0.10.2"><a class="docs-heading-anchor" href="#Version-0.10.2">Version 0.10.2</a><a id="Version-0.10.2-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.10.2" title="Permalink"></a></h4><ul><li>Minor (efficiency) improvement if states are SVectors.</li><li>Require ModiaBase 0.9.2 (to get rid of performance issues in Modia3D).</li><li>Replace ustrip(..) with ustrip.(..) at some places to get rid of warnings.</li></ul><h4 id="Version-0.10.1"><a class="docs-heading-anchor" href="#Version-0.10.1">Version 0.10.1</a><a id="Version-0.10.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.10.1" title="Permalink"></a></h4><ul><li>Update of Manifest.toml file</li><li>Require ModiaBase 0.9.1 (with updated Manifest.toml file).</li></ul><h4 id="Version-0.10.0"><a class="docs-heading-anchor" href="#Version-0.10.0">Version 0.10.0</a><a id="Version-0.10.0-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.10.0" title="Permalink"></a></h4><ul><li>Require DifferentialEquations.jl version 7.</li><li>Cleanup of using/export</li><li>Cleanup of Project.toml/Manifest.toml.´</li><li>@reexport using Unitful</li><li>@reexport using DifferentialEquations</li><li>Cleanup of test files (besides ModiaLang, no other package needed in the environment to run the tests).</li><li>Change <code>SimulationModel{FloatType,ParType,EvaluatedParType,TimeType}</code> to <code>SimulationModel{FloatType,TimeType}</code></li></ul><h4 id="Version-0.9.1-2"><a class="docs-heading-anchor" href="#Version-0.9.1-2">Version 0.9.1</a><a class="docs-heading-anchor-permalink" href="#Version-0.9.1-2" title="Permalink"></a></h4><ul><li>New function plotPath to plot a PTP_path</li><li>Replace ustrip(..) with ustrip.(..) at some places to get rid of warnings.</li><li>Include time in error message, if simulation failed</li></ul><h4 id="Version-0.9.0-2"><a class="docs-heading-anchor" href="#Version-0.9.0-2">Version 0.9.0</a><a class="docs-heading-anchor-permalink" href="#Version-0.9.0-2" title="Permalink"></a></h4><ul><li>Require Julia 1.7</li><li>Upgrade Manifest.toml to version 2.0</li><li>Update Project.toml/Manifest.toml</li></ul><h4 id="Version-0.8.7"><a class="docs-heading-anchor" href="#Version-0.8.7">Version 0.8.7</a><a id="Version-0.8.7-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.7" title="Permalink"></a></h4><ul><li>Packages used in test models, prefixed with ModiaLang. to avoid missing package errors.</li><li>Deactivating test with DoubleFloats, since not in Project.toml</li><li>Version/date updated</li></ul><h4 id="Version-0.8.6"><a class="docs-heading-anchor" href="#Version-0.8.6">Version 0.8.6</a><a id="Version-0.8.6-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.6" title="Permalink"></a></h4><ul><li>Require ModiaResult, version 0.3.9</li><li>Project.toml/Manifest.toml updated</li></ul><h4 id="Version-0.8.5"><a class="docs-heading-anchor" href="#Version-0.8.5">Version 0.8.5</a><a id="Version-0.8.5-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.8.5" title="Permalink"></a></h4><ul><li>simulate!(..):<ul><li>Trigger an error, if simulation is not successful (retcode is neither :Default nor :Success nor :Terminate)</li><li>Use RightRootFind for zero crossings (improves state events based on new DifferentialEquations option)</li><li>New keyword argument requiredFinalStates_atol=0.0.</li><li>Improve docu (e.g. add return argument solution).</li><li>Show correct integrator name QBDF in simulation log (instead of QNDF)</li><li>Raise an error, if (relative) tolerance is too small for FloatType</li><li>Use FloatType for zero crossing hysteresis, instead of Float64</li><li>If log=true print info about end of initialization.</li></ul></li></ul><ul><li>Support of MonteCarloMeasurements with units + new test model TestLinearEquationSystemWithUnitsAndMonteCarlo.jl</li></ul><ul><li>Fixing and activating the deactivated test TestTwoInertiasAndIdealGearWithUnitsAndMonteCarlo.jl.</li></ul><h4 id="Version-0.8.4-2"><a class="docs-heading-anchor" href="#Version-0.8.4-2">Version 0.8.4</a><a class="docs-heading-anchor-permalink" href="#Version-0.8.4-2" title="Permalink"></a></h4><ul><li>FloatType is included in the name space of Core.eval when evaluating parameters.</li></ul><ul><li>Version and Date updated</li></ul><ul><li>Included Version in printout of runtests.jl and runtests_withPlot.jl</li></ul><ul><li>Print difference of finalStates and requiredFinalStates in case they do not match with the given tolerance.</li></ul><h4 id="Version-0.8.3-2"><a class="docs-heading-anchor" href="#Version-0.8.3-2">Version 0.8.3</a><a class="docs-heading-anchor-permalink" href="#Version-0.8.3-2" title="Permalink"></a></h4><ul><li>Project.toml, Manifest.toml updated: Require newest version 0.7.7 of ModiaBase (containing a bug fix)</li></ul><ul><li>Minor correction of simulate!(log=true) output</li></ul><h4 id="Version-0.8.2-2"><a class="docs-heading-anchor" href="#Version-0.8.2-2">Version 0.8.2</a><a class="docs-heading-anchor-permalink" href="#Version-0.8.2-2" title="Permalink"></a></h4><ul><li>Issue with tearing fixed: Variables are only explicitly solved, if linear factor is a non-zero literal number (previously a division by zero could occur, if the linear factor became zero during simulation).</li></ul><ul><li>Issue with unit of tearing variable fixed, if it is a derivative of a variable (previously, the generated code for unitless=false was wrong, if the tearing variable was  a derivative, since the unit was not taken into account).</li></ul><ul><li>simulate!(..):<ul><li>Support DAE integrators, especially IDA() from Sundials.</li><li>New keyword <code>useRecursiveFactorizationUptoSize=0</code>: Linear equation systems A*v=b are solved with <a href="https://github.com/YingboMa/RecursiveFactorization.jl">RecursiveFactorization.jl</a> instead of the default <code>lu!(..)</code> and <code>ldiv!(..)</code>, if <code>length(v) &lt;= useRecursiveFactorizationUptoSize</code>. According to <code>RecursiveFactorization.jl</code> docu, it is faster as <code>lu!(..)</code> with OpenBLAS, for <code>length(v) &lt;= 500</code> (typically, more as a factor of two). Since there had been some cases where <code>lu!(..)!</code> was successful, but <code>RecursiveFactorization.jl</code> failed due to a singular system, the default is to use <code>lu!(..)!</code>.</li><li>If log=true, sizes of linear equation systems are listed, as well as whether RecursiveFactorization.jl is used for the respective system.</li></ul></li></ul><ul><li>Test for RecursiveFactorization.jl added in TestTwoInertiasAndIdealGear.jl</li></ul><ul><li>Some test models corrected (since leading to errors with the above changes).</li></ul><ul><li>Updated Project.toml and Manifest.toml with newest versions of packages (including MonteCarloMeasurements, version &gt;= 1) and improved Project.toml file to reduce issues with package constraints</li></ul><h4 id="Version-0.8.1-2"><a class="docs-heading-anchor" href="#Version-0.8.1-2">Version 0.8.1</a><a class="docs-heading-anchor-permalink" href="#Version-0.8.1-2" title="Permalink"></a></h4><ul><li>Added a minimal documentation, including release notes.</li><li>No message anymore, when ModiaLang is started.</li><li>Fixed bug that <code>using ModiaResult</code> is needed, when calling <code>@usingModiaPlot</code>.</li></ul><h4 id="Version-0.8.0-2"><a class="docs-heading-anchor" href="#Version-0.8.0-2">Version 0.8.0</a><a class="docs-heading-anchor-permalink" href="#Version-0.8.0-2" title="Permalink"></a></h4><ul><li>Improved scalability by using OrderedDicts instead of named tuples for models, variables and parameter modifications.</li><li>Speed improvements for structural and symbolic algorithms.</li><li>Added support for state events, time events and synchronous operators.</li><li>Added support for mixed linear equation systems having Real and Boolean unknowns.</li><li>Added support for user-defined components defined by structs and functions (multibody modeling with Modia3D is based on this feature). This makes it possible to utilize algorithms specialized for a component.</li><li>Added support for numerical and analytic linearization.</li><li>Added support for propagation of parameters (e.g. deep in a model, the value of a parameter can be defined as a function of some top level parameter and this parameter is changed before simulation starts).</li><li>New small model libraries Translational.jl and PathPlanning.jl added.</li><li>Result storage changed: <code>sol = simulate!(...)</code> calls internally <code>sol = solve(..)</code> from   DifferentialEquations.jl. <code>sol</code> contains time and the states at the communication time grid and at events. This is now kept in simulate(..), so the return value of simulate!(..) can be exactly used as if <code>solve(..)</code> would have been used directly.</li><li>The plot(..) command now supports the following underlying plot packages: <a href="https://github.com/JuliaPy/PyPlot.jl">PyPlot</a>, <a href="https://github.com/JuliaPlots/GLMakie.jl">GLMakie</a>, <a href="https://github.com/JuliaPlots/WGLMakie.jl">WGLMakie</a>, and <a href="https://github.com/JuliaPlots/CairoMakie.jl">CairoMakie</a>. It is also possible to select <code>NoPlot</code>, to ignore <code>plot(..)</code> calls or <code>SilenNoPlot</code> to ignore <code>plot(..)</code> calls silently. The latter is useful for <code>runtests.jl</code>. Note, often <a href="https://github.com/JuliaPy/PyPlot.jl">PyPlot</a> is the best choice.</li></ul><p>Changes that are <strong>not backwards compatible</strong> to version 0.7.x:</p><ul><li>Models are OrderedDicts and no longer NamedTuples.</li></ul><ul><li>simulate!(..):<ul><li>If FloatType=Float64 and no algorithm is defined, then Sundials.CVODE_BDF() is used instead of the default algorithm of DifferentialEquations as in 0.7. The reason is that Modia models are usually large and expensive to evaluate and have often stiff parts, so that multi-step methods are often by far the best choice. CVODE_BDF() seems to be a good choice in many applications (another algorithm should be used, if there are many events, highly oscillatory vibrations, or if all states are non-stiff).</li><li>The default value of <code>stopTime</code> is equal to <code>startTime</code> (which has a default value of 0.0 s), and is no longer 1.0 s.</li></ul></li></ul><ul><li>Plotting is defined slightly differently (<code>@useModiaPlot</code>, instead of <code>using ModiaPlot</code>).</li></ul><h4 id="Version-0.7.3"><a class="docs-heading-anchor" href="#Version-0.7.3">Version 0.7.3</a><a id="Version-0.7.3-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.3" title="Permalink"></a></h4><ul><li>Evaluation and propagation of parameter expressions (also in simulate!(..., merge=Map(...))). Propagation of start/init values of states is not yet supported.</li></ul><ul><li>State events supported.</li></ul><h4 id="Version-0.7.2"><a class="docs-heading-anchor" href="#Version-0.7.2">Version 0.7.2</a><a id="Version-0.7.2-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.2" title="Permalink"></a></h4><ul><li>Missing dependency of Test package added.</li></ul><h4 id="Version-0.7.1"><a class="docs-heading-anchor" href="#Version-0.7.1">Version 0.7.1</a><a id="Version-0.7.1-1"></a><a class="docs-heading-anchor-permalink" href="#Version-0.7.1" title="Permalink"></a></h4><ul><li>Variable constructor <code>Var(...)</code> introduced. For example: <code>v = input | Var(init = 1.2u&quot;m&quot;)</code>.</li></ul><ul><li>Functions are called in the scope where macro <code>@instantiateModel</code> is called.</li></ul><ul><li>New arguments of function <code>simulate!</code>:<ul><li>Parameter and init/start values can be changed with argument <code>merge</code>.</li><li>A simulation can be checked with argument <code>requiredFinalStates</code>.</li><li>Argument <code>logParameters</code> lists the parameter and init/start values used for the simulation.</li><li>Argument <code>logStates</code> lists the states, init, and nominal values used for the simulation.</li></ul></li></ul><ul><li><code>end</code> in array ranges is supported, for example <code>v[2:end]</code>.</li></ul><ul><li>New (small) model library <code>Modia/models/HeatTransfer.jl</code>.</li></ul><ul><li>Modia Tutorial improved.</li></ul><ul><li>Functions docu improved.</li></ul><h4 id="Version-0.7.0-2"><a class="docs-heading-anchor" href="#Version-0.7.0-2">Version 0.7.0</a><a class="docs-heading-anchor-permalink" href="#Version-0.7.0-2" title="Permalink"></a></h4><ul><li>Initial version, based on code developed for Modia 0.6 and ModiaMath 0.6.</li></ul><h2 id="Main-developers"><a class="docs-heading-anchor" href="#Main-developers">Main developers</a><a id="Main-developers-1"></a><a class="docs-heading-anchor-permalink" href="#Main-developers" title="Permalink"></a></h2><ul><li><a href="mailto:Hilding.Elmqvist@Mogram.net">Hilding Elmqvist</a>, <a href="http://www.mogram.net/">Mogram</a>.</li></ul><ul><li><a href="https://rmc.dlr.de/sr/en/staff/martin.otter/">Martin Otter</a>, <a href="https://www.dlr.de/sr/en">DLR - Institute of System Dynamics and Control</a>.</li></ul></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="tutorial/Tutorial.html">Modia Tutorial »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.19 on <span class="colophon-date" title="Sunday 10 July 2022 11:58">Sunday 10 July 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
